// é…’åº—è®¢å•æ•°æ®æ¨¡å‹
@Observed
export class HotelOrder {
  id: string;
  hotelName: string;
  hotelImage: string;
  roomType: string;
  checkInDate: string;
  checkOutDate: string;
  totalPrice: number;
  status: OrderStatus;
  orderTime: string;
  guestName: string;
  guestPhone: string;
  roomCount: number;
  nights: number;

  constructor(
    id: string,
    hotelName: string,
    hotelImage: string,
    roomType: string,
    checkInDate: string,
    checkOutDate: string,
    totalPrice: number,
    status: OrderStatus,
    orderTime: string,
    guestName: string,
    guestPhone: string,
    roomCount: number = 1,
    nights: number = 1
  ) {
    this.id = id;
    this.hotelName = hotelName;
    this.hotelImage = hotelImage;
    this.roomType = roomType;
    this.checkInDate = checkInDate;
    this.checkOutDate = checkOutDate;
    this.totalPrice = totalPrice;
    this.status = status;
    this.orderTime = orderTime;
    this.guestName = guestName;
    this.guestPhone = guestPhone;
    this.roomCount = roomCount;
    this.nights = nights;
  }
}

export enum OrderStatus {
  ALL = 0,
  PENDING_PAYMENT = 1,
  PENDING_CHECKIN = 2,
  WAITING_EVALUATE = 3
}

export class OrderStatusInfo {
  static getStatusText(status: OrderStatus): string {
    switch (status) {
      case OrderStatus.ALL:
        return 'å…¨éƒ¨';
      case OrderStatus.PENDING_PAYMENT:
        return 'å¾…æ”¯ä»˜';
      case OrderStatus.PENDING_CHECKIN:
        return 'å¾…å…¥ä½';
      case OrderStatus.WAITING_EVALUATE:
        return 'å¾…è¯„ä»·';
      default:
        return 'å…¨éƒ¨';
    }
  }

  static getActionText(status: OrderStatus): string {
    switch (status) {
      case OrderStatus.PENDING_PAYMENT:
        return 'å»æ”¯ä»˜';
      case OrderStatus.PENDING_CHECKIN:
        return 'å†æ¬¡é¢„è®¢';
      case OrderStatus.WAITING_EVALUATE:
        return 'ç«‹å³è¯„ä»·';
      default:
        return 'æŸ¥çœ‹è¯¦æƒ…';
    }
  }

  static getActionButtonColor(status: OrderStatus): string {
    switch (status) {
      case OrderStatus.PENDING_PAYMENT:
        return '#FF6B35';
      case OrderStatus.PENDING_CHECKIN:
        return '#007AFF';
      case OrderStatus.WAITING_EVALUATE:
        return '#34C759';
      default:
        return '#007AFF';
    }
  }
}

export class HotelOrderData {
  // å…¨å±€è®¢å•å­˜å‚¨ï¼ˆåº”ç”¨è¿è¡ŒæœŸå†…æœ‰æ•ˆï¼‰
  private static orders: HotelOrder[] = [];

  // åˆå§‹åŒ–å…¨å±€è®¢å•ï¼ˆåªåœ¨é¦–æ¬¡è°ƒç”¨æ—¶å¡«å……ä¸€æ¬¡ï¼‰
  static getCurrentOrders(): HotelOrder[] {
    if (HotelOrderData.orders.length === 0) {
      HotelOrderData.orders = HotelOrderData.getMockOrders();
    }
    return HotelOrderData.orders;
  }

  static addOrder(order: HotelOrder): void {
    // æ–°è®¢å•ç½®é¡¶
    HotelOrderData.orders = [order, ...HotelOrderData.getCurrentOrders()];
  }

  static updateOrderStatus(orderId: string, status: OrderStatus): void {
    const list = HotelOrderData.getCurrentOrders();
    const idx = list.findIndex(o => o.id === orderId);
    if (idx >= 0) {
      list[idx].status = status;
      HotelOrderData.orders = [...list];
    }
  }

  static getMockOrders(): HotelOrder[] {
    return [
      new HotelOrder(
        '001',
        'è±ªåé…’åº—',
        'ğŸ¨',
        'è±ªåå¤§åºŠæˆ¿',
        '2025/07/07',
        '2025/07/09',
        489.45,
        OrderStatus.WAITING_EVALUATE,
        '2025-07-05 14:30',
        'å¼ ä¸‰',
        '13800138000',
        1,
        2
      ),
      new HotelOrder(
        '002',
        'æµ·æ™¯åº¦å‡æ‘',
        'ğŸ–ï¸',
        'æµ·æ™¯å¥—æˆ¿',
        '2025/08/15',
        '2025/08/18',
        1299.00,
        OrderStatus.PENDING_CHECKIN,
        '2025-07-20 09:15',
        'æå››',
        '13900139000',
        1,
        3
      ),
      new HotelOrder(
        '003',
        'å•†åŠ¡é…’åº—',
        'ğŸ¢',
        'æ ‡å‡†åŒåºŠæˆ¿',
        '2025/09/10',
        '2025/09/12',
        356.80,
        OrderStatus.PENDING_PAYMENT,
        '2025-09-08 16:45',
        'ç‹äº”',
        '13700137000',
        1,
        2
      ),
      new HotelOrder(
        '004',
        'æ¸©æ³‰é…’åº—',
        'â™¨ï¸',
        'æ¸©æ³‰å¤§åºŠæˆ¿',
        '2025/10/01',
        '2025/10/03',
        688.90,
        OrderStatus.PENDING_CHECKIN,
        '2025-09-25 11:20',
        'èµµå…­',
        '13600136000',
        1,
        2
      ),
      new HotelOrder(
        '005',
        'ç²¾å“æ°‘å®¿',
        'ğŸ¡',
        'å¤å¼å¥—æˆ¿',
        '2025/11/20',
        '2025/11/22',
        456.70,
        OrderStatus.WAITING_EVALUATE,
        '2025-11-18 20:30',
        'å­™ä¸ƒ',
        '13500135000',
        1,
        2
      )
    ];
  }

  static getOrdersByStatus(orders: HotelOrder[], status: OrderStatus): HotelOrder[] {
    if (status === OrderStatus.ALL) {
      return orders;
    }
    return orders.filter(order => order.status === status);
  }
}
