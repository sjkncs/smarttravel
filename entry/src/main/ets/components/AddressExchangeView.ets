@Component
export struct AddressExchangeView {
  @State departureAddress: string = '';
  @State destinationAddress: string = '';
  @State isAnimating: boolean = false;

  // åœ°å€äº¤æ¢åŠ¨ç”»
  private async swapAddresses() {
    if (this.isAnimating) return;
    
    this.isAnimating = true;
    
    // ä½¿ç”¨animateToå®žçŽ°åœ°å€äº¤æ¢åŠ¨ç”»
    animateTo({
      duration: 500,
      curve: Curve.EaseInOut,
      onFinish: () => {
        this.isAnimating = false;
      }
    }, () => {
      const temp = this.departureAddress;
      this.departureAddress = this.destinationAddress;
      this.destinationAddress = temp;
    });
  }

  // æ¸…ç©ºåœ°å€
  private clearAddresses() {
    this.departureAddress = '';
    this.destinationAddress = '';
  }

  build() {
    Column() {
      // æ ‡é¢˜
      Row() {
        Text('åœ°å€äº¤æ¢')
          .fontSize(20)
          .fontWeight(FontWeight.Bold)
          .fontColor('#1e40af')
        
        Blank()
        
        Button() {
          Text('æ¸…ç©º')
            .fontSize(14)
            .fontColor('#64748b')
        }
        .height(32)
        .backgroundColor('#f1f5f9')
        .borderRadius(16)
        .padding({ left: 12, right: 12 })
        .onClick(() => {
          this.clearAddresses();
        })
      }
      .width('100%')
      .margin({ bottom: 20 })
      
      // å‡ºå‘åœ°è¾“å…¥
      Column() {
        Text('å‡ºå‘åœ°')
          .fontSize(16)
          .fontColor('#64748b')
          .alignSelf(ItemAlign.Start)
          .margin({ bottom: 8 })
        
        TextInput({ 
          placeholder: 'è¯·è¾“å…¥å‡ºå‘åœ°',
          text: this.departureAddress
        })
          .width('100%')
          .height(48)
          .fontSize(16)
          .fontColor('#1e293b')
          .backgroundColor('#f8fafc')
          .borderRadius(12)
          .padding({ left: 16, right: 16 })
          .border({
            width: 1,
            color: '#e2e8f0'
          })
          .onChange((value: string) => {
            this.departureAddress = value;
          })
      }
      .width('100%')
      .margin({ bottom: 16 })
      
      // äº¤æ¢æŒ‰é’®
      Button() {
        Text('ðŸ”„')
          .fontSize(20)
          .fontColor(this.isAnimating ? '#94a3b8' : '#1e40af')
      }
      .width(48)
      .height(48)
      .backgroundColor(this.isAnimating ? '#f1f5f9' : '#f0f8ff')
      .borderRadius(24)
      .margin({ bottom: 16 })
      .enabled(!this.isAnimating)
      .onClick(() => {
        this.swapAddresses();
      })
      
      // ç›®çš„åœ°è¾“å…¥
      Column() {
        Text('ç›®çš„åœ°')
          .fontSize(16)
          .fontColor('#64748b')
          .alignSelf(ItemAlign.Start)
          .margin({ bottom: 8 })
        
        TextInput({ 
          placeholder: 'è¯·è¾“å…¥ç›®çš„åœ°',
          text: this.destinationAddress
        })
          .width('100%')
          .height(48)
          .fontSize(16)
          .fontColor('#1e293b')
          .backgroundColor('#f8fafc')
          .borderRadius(12)
          .padding({ left: 16, right: 16 })
          .border({
            width: 1,
            color: '#e2e8f0'
          })
          .onChange((value: string) => {
            this.destinationAddress = value;
          })
      }
      .width('100%')
      
      // æ“ä½œæŒ‰é’®
      Row() {
        Button() {
          Text('å¼€å§‹å¯¼èˆª')
            .fontSize(16)
            .fontWeight(FontWeight.Medium)
            .fontColor(Color.White)
        }
        .layoutWeight(1)
        .height(48)
        .backgroundColor('#1e40af')
        .borderRadius(24)
        .margin({ right: 8 })
        .enabled(this.departureAddress.length > 0 && this.destinationAddress.length > 0)
        .onClick(() => {
          // å¼€å§‹å¯¼èˆªé€»è¾‘
          console.log('å¼€å§‹å¯¼èˆª:', this.departureAddress, '->', this.destinationAddress);
        })
        
        Button() {
          Text('æŸ¥çœ‹è·¯çº¿')
            .fontSize(16)
            .fontColor('#1e40af')
        }
        .layoutWeight(1)
        .height(48)
        .backgroundColor('#f0f8ff')
        .borderRadius(24)
        .margin({ left: 8 })
        .enabled(this.departureAddress.length > 0 && this.destinationAddress.length > 0)
        .onClick(() => {
          // æŸ¥çœ‹è·¯çº¿é€»è¾‘
          console.log('æŸ¥çœ‹è·¯çº¿:', this.departureAddress, '->', this.destinationAddress);
        })
      }
      .width('100%')
      .margin({ top: 20 })
    }
    .width('100%')
    .padding(20)
    .backgroundColor(Color.White)
    .borderRadius(16)
    .shadow({
      radius: 8,
      color: 'rgba(0,0,0,0.1)',
      offsetX: 0,
      offsetY: 4
    })
  }
}
